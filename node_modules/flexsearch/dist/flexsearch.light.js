/*
 FlexSearch v0.6.22
 Copyright 2019 Nextapps GmbH
 Author: Thomas Wilkerling
 Released under the Apache 2.0 Licence
 https://github.com/nextapps-de/flexsearch
*/
'use strict';(function(n,C,D){let x;(x=D.define)&&x.amd?x([],function(){return C}):(x=D.modules)?x[n.toLowerCase()]=C:"object"===typeof exports?module.exports=C:D[n]=C})("FlexSearch",function(){function n(a,b){const c=b?b.id:a&&a.id;this.id=c||0===c?c:S++;this.init(a,b);D(this,"index",function(){return Object.keys(this.c)});D(this,"length",function(){return this.index.length})}function C(a,b){const c=a.length,g=G(b),e=[];for(let h=0,f=0;h<c;h++){const d=a[h];if(g&&b(d)||!g&&!b[d])e[f++]=d}return e}
function D(a,b,c){Object.defineProperty(a,b,{get:c})}function x(a,b){for(let c=0;c<b.length;c+=2)a=a.replace(b[c],b[c+1]);return a}function H(a,b,c,g,e,h,f,d){if(b[c])return b[c];e=e?(d-(f||d/1.5))*h+(f||d/1.5)*e:h;b[c]=e;e>=f&&(a=a[d-(e+.5>>0)],a=a[c]||(a[c]=[]),a[a.length]=g);return e}function L(a,b){if(a){const c=Object.keys(a);for(let g=0,e=c.length;g<e;g++){const h=c[g],f=a[h];if(f)for(let d=0,k=f.length;d<k;d++)if(f[d]===b){1===k?delete a[h]:f.splice(d,1);break}else"object"===typeof f[d]&&L(f[d],
b)}}}function T(a,b){a=a.length-b.length;return 0>a?1:a?-1:0}function M(a,b,c){return a?{page:a,next:b?""+b:null,result:c}:c}function I(a){return"string"===typeof a}function G(a){return"function"===typeof a}function J(a){return"undefined"===typeof a}function O(a){const b=Array(a);for(let c=0;c<a;c++)b[c]=y();return b}function y(){return Object.create(null)}const B={encode:"icase",b:"forward",split:/\W+/,cache:!1,async:!1,m:!1,i:!1,l:!1,a:9,threshold:0,depth:0},N=[];let S=0;const P={},Q={};n.create=
function(a,b){return new n(a,b)};n.registerMatcher=function(a){for(const b in a)a.hasOwnProperty(b)&&N.push(new RegExp(b,"g"),a[b]);return this};n.registerEncoder=function(a,b){E[a]=b.bind(E);return this};n.registerLanguage=function(a,b){P[a]=b.filter;Q[a]=b.stemmer;return this};n.encode=function(a,b){return E[a](b)};n.prototype.init=function(a,b){this.j=[];if(b){var c=b.preset;a=b}else a||(a=B),c=a.preset;b={};this.b=a.tokenize||b.b||this.b||B.b;this.split=a.split||this.split||B.split;this.i=a.rtl||
this.i||B.i;this.threshold=J(c=a.threshold)?b.threshold||this.threshold||B.threshold:c;this.a=J(c=a.resolution)?c=b.a||this.a||B.a:c;c<=this.threshold&&(this.a=this.threshold+1);this.depth="strict"!==this.b||J(c=a.depth)?b.depth||this.depth||B.depth:c;this.g=(c=J(c=a.encode)?b.encode||B.encode:c)&&E[c]&&E[c].bind(E)||(G(c)?c:this.g||!1);(c=a.matcher)&&this.addMatcher(c);if(c=(b=a.lang)||a.filter){I(c)&&(c=P[c]);if(c.constructor===Array){{var g=this.g;const h=y();for(let f=0;f<c.length;f++){const d=
g?g(c[f]):c[f];h[d]=1}c=h}}this.filter=c}if(c=b||a.stemmer){var e;a=I(c)?Q[c]:c;b=this.g;c=[];for(e in a)a.hasOwnProperty(e)&&(g=b?b(e):e,c.push(new RegExp(g+"($|\\W)","g"),b?b(a[e]):a[e]));this.stemmer=e=c}this.h=O(this.a-(this.threshold||0));this.f=y();this.c=y();return this};n.prototype.encode=function(a){a&&N.length&&(a=x(a,N));a&&this.j.length&&(a=x(a,this.j));a&&this.g&&(a=this.g(a));a&&this.stemmer&&(a=x(a,this.stemmer));return a};n.prototype.addMatcher=function(a){const b=this.j;for(const c in a)a.hasOwnProperty(c)&&
b.push(new RegExp(c,"g"),a[c]);return this};n.prototype.add=function(a,b,c,g,e){if(b&&I(b)&&(a||0===a)){const t="@"+a;if(this.c[t]&&!g)return this.update(a,b);if(!e&&c)return this.add(a,b,null,g,!0),c(),this;b=this.encode(b);if(!b.length)return this;c=this.b;b=G(c)?c(b):b.split(this.split);this.filter&&(b=C(b,this.filter));g=y();g._ctx=y();e=b.length;const r=this.threshold,u=this.depth,v=this.a,p=this.h,m=this.i;for(let q=0;q<e;q++){var h=b[q];if(h){var f=h.length,d=(m?q+1:e-q)/e,k="";switch(c){case "reverse":case "both":for(var l=
f;--l;)k=h[l]+k,H(p,g,k,a,m?1:(f-l)/f,d,r,v-1);k="";case "forward":for(l=0;l<f;l++)k+=h[l],H(p,g,k,a,m?(l+1)/f:1,d,r,v-1);break;case "full":for(l=0;l<f;l++){const F=(m?l+1:f-l)/f;for(let w=f;w>l;w--)k=h.substring(l,w),H(p,g,k,a,F,d,r,v-1)}break;default:if(f=H(p,g,h,a,1,d,r,v-1),u&&1<e&&f>=r)for(f=g._ctx[h]||(g._ctx[h]=y()),h=this.f[h]||(this.f[h]=O(v-(r||0))),d=q-u,k=q+u+1,0>d&&(d=0),k>e&&(k=e);d<k;d++)d!==q&&H(h,f,b[d],a,0,v-(d<q?q-d:d-q),r,v-1)}}}this.c[t]=1}return this};n.prototype.update=function(a,
b,c){this.c["@"+a]&&I(b)&&(this.remove(a),this.add(a,b,c,!0));return this};n.prototype.remove=function(a,b,c){const g="@"+a;if(this.c[g]){if(!c&&b)return this.remove(a,null,!0),b(),this;for(b=0;b<this.a-(this.threshold||0);b++)L(this.h[b],a);this.depth&&L(this.f,a);delete this.c[g]}return this};n.prototype.search=function(a,b,c,g){b&&G(b)?(c=b,b=1E3):b||0===b||(b=1E3);var e=[],h=a;if("object"===typeof a){var f=!1;b=a.limit;var d=a.threshold;var k=!1;a=a.query}d||(d=this.threshold||0);if(!g&&c)return c(this.search(h,
b,null,!0)),this;if(!a||!I(a))return e;h=this.encode(a);if(!h.length)return e;a=this.b;a=G(a)?a(h):h.split(this.split);this.filter&&(a=C(a,this.filter));c=a.length;g=!0;h=[];var l=y(),t,r=0;1<c&&(this.depth&&"strict"===this.b?t=!0:a.sort(T));var u;if(!t||(u=this.f))for(var v=this.a;r<c;r++){var p=a[r];if(p){if(t){if(!m)if(u[p]){var m=p;l[p]=1}else if(!k)return e;if(k&&r===c-1&&!h.length)t=!1,p=m||p,l[p]=0;else if(!m)continue}if(!l[p]){var q=[],F=!1;let z=0;if(m=t?u[m]:this.h){let R;for(let K=0;K<
v-d;K++)if(R=m[K]&&m[K][p])q[z++]=R,F=!0}if(F)m=p,h[h.length]=1<z?q.concat.apply([],q):q[0];else{g=!1;break}l[p]=1}}}else g=!1;if(g)a:{let z;e=[];!0===f?(f="0",d=""):d=f&&f.split(":");k=h.length;if(1<k){t=y();m=0;v=!0;g=0;var w;for(d&&(2===d.length?d=!1:d=w=parseInt(d[0],10));m<k;m++){l=m===k-1;u=h[m];c=u.length;if(!c){e=M(f,z,u);break a}if(v)if(A){r=A.length;for(a=0;a<r;a++)t["@"+A[a]]=1;var A=null;v=!1}else{A=u;continue}p=!1;for(a=0;a<c;a++)if(r=u[a],q="@"+r,(F=t[q]||0)&&F===m){if(l){if(!w||--w<
g)if(e[g++]=r,b&&g===b){e=M(f,g+(d||0),e);break a}}else t[q]=m+1;p=!0}if(!p)break}A&&(e=A)}else k&&(e=h[0],d&&(d=parseInt(d[0],10)));b&&(A=e.length,d&&d>A&&(d=0),w=d||0,z=w+b,z<A?e=e.slice(w,z):(z=0,w&&(e=e.slice(w))));e=M(f,z,e)}return e};n.prototype.clear=function(){return this.destroy().init()};n.prototype.destroy=function(){this.h=this.f=this.c=null;return this};const E={icase:function(a){return a.toLowerCase()}};return n}(!1),this);
